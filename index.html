<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fluxo â€” Brat Ultra Deluxe âœ¦ Abhiii</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Montserrat:wght@400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">

  <!-- html2canvas -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

  <style>
    :root{
      --bg:#fff3f8;
      --card:#fff;
      --muted:#9aa8b8;
      --accent:#ff7ab6;
      --accent2:#ffb3d9;
      --radius:18px;
      --text-dark:#0b1020;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial,-apple-system; -webkit-font-smoothing:antialiased; background:var(--bg); color:var(--text-dark)}
    a{color:inherit}

    /* Container */
    .wrap { max-width:900px; margin:18px auto; padding:18px; }
    header.top { display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:16px; }
    .brand { font-family:"Playfair Display", serif; font-size:28px; background:linear-gradient(90deg,var(--accent),var(--accent2)); -webkit-background-clip:text; color:transparent; font-weight:700;}
    .tag { color:var(--muted); font-size:13px; margin-top:4px; }

    /* Main layout */
    .main { display:grid; grid-template-columns: 1fr 360px; gap:20px; align-items:start; }
    @media(max-width:980px){ .main{ grid-template-columns:1fr } }

    /* Card styling */
    .card { background:var(--card); border-radius:var(--radius); padding:16px; box-shadow: 0 10px 30px rgba(17,24,39,0.06); border:1px solid rgba(0,0,0,0.02); }
    .lead { font-size:18px; color:#111827; font-weight:700; margin-bottom:6px; }
    .sub { color:var(--muted); font-size:13px; margin-bottom:8px; }

    /* Brat preview */
    .preview-wrap { margin-bottom:12px; display:flex; justify-content:center; }
    .preview-card { width:100%; max-width:760px; height:380px; border-radius:18px; background:linear-gradient(180deg,#ffdfe9,#fff0f5); display:flex; align-items:center; justify-content:center; padding[...]
    .preview-inner { width:100%; height:100%; display:flex; align-items:center; justify-content:center; text-align:center; padding:12px; box-sizing:border-box; word-break:break-word; line-height:0.95;[...]
    .preview-text { display:block; width:100%; color:var(--text-dark); font-weight:800; letter-spacing: -0.02em; }

    /* Watermark small bottom */
    .watermark { position:absolute; bottom:10px; right:14px; font-size:12px; color:rgba(10,10,10,0.22); backdrop-filter:none; pointer-events:none; }

    /* Controls */
    .controls { display:flex; flex-direction:column; gap:12px; }
    .row { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
    .label { font-size:13px; color:#374151; margin-bottom:6px; font-weight:600; }
    input[type="text"], textarea, select { width:100%; padding:12px 14px; border-radius:12px; border:1px solid rgba(15,23,42,0.06); background:#fff; font-size:15px; color:var(--text-dark); outline:non[...]
    textarea { min-height:110px; resize:vertical }
    .small { padding:8px 10px; border-radius:10px; background:rgba(0,0,0,0.03); border:1px solid rgba(0,0,0,0.04); cursor:pointer; font-weight:600; }

    /* Buttons */
    .btn { background:linear-gradient(90deg,var(--accent),var(--accent2)); color:#041025; border:none; padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:700; box-shadow:0 10px 20px rg[...]
    .ghost { background:transparent; border:1px solid rgba(0,0,0,0.06); padding:9px 12px; border-radius:12px; cursor:pointer }
    .generate { background:linear-gradient(90deg,#ff66b3,#ff3a82); color:white; padding:14px; border-radius:14px; border:none; font-weight:800; font-size:16px }

    /* Swatches */
    .swatches { display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    .swatch { width:36px; height:36px; border-radius:10px; border:2px solid rgba(0,0,0,0.04); cursor:pointer; box-shadow:0 6px 18px rgba(0,0,0,0.04) }

    /* Slider label */
    .meta { font-size:13px; color:var(--muted) }

    /* Footer */
    footer.sitefoot { text-align:center; margin-top:18px; color:var(--muted); font-size:13px; padding-bottom:36px; }

    /* Small UI tweaks */
    .muted { color:var(--muted); font-size:13px }
    .align-buttons .small { min-width:60px; text-align:center }
    .toggle-row { display:flex; gap:8px; align-items:center; flex-wrap:wrap }

    /* Pro badge */
    .pro-badge { background:linear-gradient(90deg,#ffd166,#ff7a00); padding:6px 10px; border-radius:999px; color:#041025; font-weight:700; font-size:12px }

    /* Helper hidden while capturing */
    .hide-for-export { transition:opacity .12s ease; }

    /* Responsive preview text sizing fallback */
    @media(max-width:720px){
      .preview-card { height:340px; padding:18px }
    }
  </style>
</head>
<body>

  <div class="wrap">
    <header class="top">
      <div>
        <div class="brand">Fluxo <span style="font-size:12px; font-weight:400; color:#9b6a7a; margin-left:8px">âœ¦ make your edits flowww</span></div>
        <div class="tag">crafted with ðŸ’– by Abhiii â€” for the Meme Geeks</div>
      </div>

      <div style="display:flex;gap:10px;align-items:center">
        <div id="proBadge" style="display:none" class="pro-badge">Fluxo Ultra Pro</div>
        <button id="unlockBtn" class="ghost">Unlock Pro</button>
      </div>
    </header>

    <main class="main">

      <!-- LEFT column -->
      <section>
        <div class="card">
          <div class="lead">Brat Preview</div>
          <div class="sub">Big bold brat text card â€” use Generate to capture a clean PNG. Free: 2/day. Pro: unlimited.</div>

          <div class="preview-wrap">
            <div id="previewCard" class="preview-card" style="background:linear-gradient(180deg,#fff3f8,#ffe6f0);">
              <div id="previewInner" class="preview-inner">
                <div id="previewText" class="preview-text" style="font-size:64px">itâ€™s giving main character vibes ðŸ’…</div>
              </div>
              <div id="watermark" class="watermark">Fluxo âœ¦ Abhiii</div>
            </div>
          </div>

          <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
            <div class="meta">Exports today: <span id="exportCount">0</span>/2</div>
            <!-- Removed public password display to avoid exposing secret in page -->
            <div class="muted" style="margin-left:auto">Pro: <strong>Locked</strong></div>
          </div>
        </div>

        <!-- Controls card -->
        <div class="card" style="margin-top:14px">
          <div class="lead">Brat Controls</div>

          <div id="controlsArea" class="controls">

            <div>
              <div class="label">Your Text</div>
              <textarea id="inputText" placeholder="Type your meme text here...">itâ€™s giving main character vibes ðŸ’…</textarea>
            </div>

            <div>
              <div class="label">Font</div>
              <select id="fontSelect">
                <option value="700 64px Inter">Inter (bold)</option>
                <option value="700 56px Montserrat">Montserrat</option>
                <option value="700 56px 'Playfair Display'">Playfair</option>
                <option value="800 64px 'Segoe UI'">Segoe UI</option>
                <option value="700 54px 'Courier New'">Mono (retro)</option>
              </select>
            </div>

            <div>
              <div class="label">Text Color / Case</div>
              <div class="row">
                <input type="color" id="textColor" value="#0b1020" class="small" style="width:56px;height:40px;padding:6px;border-radius:10px"/>
                <button id="caseToggle" class="small">UPPERCASE</button>
                <div style="margin-left:auto" class="muted">Outline / Glow / Shadow</div>
              </div>
            </div>

            <div class="row" style="align-items:center">
              <div>
                <div class="label">Outline (Stroke)</div>
                <select id="outlineSelect" class="small">
                  <option value="none">No Outline</option>
                  <option value="thin">Thin</option>
                  <option value="bold">Bold</option>
                </select>
              </div>

              <div>
                <div class="label">Glow</div>
                <label class="small"><input type="checkbox" id="glowToggle" /> Enable</label>
              </div>

              <div>
                <div class="label">Drop Shadow</div>
                <label class="small"><input type="checkbox" id="shadowToggle" /> Enable</label>
              </div>
            </div>

            <div>
              <div class="label">Background Swatches</div>
              <div class="swatches" id="bgSwatches">
                <div class="swatch" data-bg="linear-gradient(180deg,#fff3f8,#ffe6f0)" style="background:linear-gradient(90deg,#fff3f8,#ffe6f0)"></div>
                <div class="swatch" data-bg="linear-gradient(180deg,#f0f9ff,#e6f7ff)" style="background:linear-gradient(90deg,#e6f7ff,#f0f9ff)"></div>
                <div class="swatch" data-bg="#ffffff" style="background:#ffffff"></div>
                <div class="swatch" data-bg="#000000" style="background:#000000"></div>
                <div class="swatch" data-bg="linear-gradient(180deg,#fff7ed,#fff1d6)" style="background:linear-gradient(90deg,#fff7ed,#fff1d6)"></div>
                <div class="swatch" data-bg="linear-gradient(180deg,#e6f7ed,#dff7ee)" style="background:linear-gradient(90deg,#e6f7ed,#dff7ee)"></div>
                <div class="swatch" data-bg="linear-gradient(180deg,#fef3f3,#fff0f5)" style="background:linear-gradient(90deg,#fef3f3,#fff0f5)"></div>

                <!-- Added extra swatches: dark green, bright pink, teal, lavender, deep purple, coral -->
                <div class="swatch" data-bg="#064e3b" style="background:linear-gradient(90deg,#064e3b,#0b6a4a)"></div>
                <div class="swatch" data-bg="#ff007f" style="background:linear-gradient(90deg,#ff007f,#ff66a3)"></div>
                <div class="swatch" data-bg="linear-gradient(180deg,#06b6d4,#67e8f9)" style="background:linear-gradient(90deg,#06b6d4,#67e8f9)"></div>
                <div class="swatch" data-bg="linear-gradient(180deg,#e9d5ff,#f3e8ff)" style="background:linear-gradient(90deg,#e9d5ff,#f3e8ff)"></div>
                <div class="swatch" data-bg="linear-gradient(180deg,#5b21b6,#7c3aed)" style="background:linear-gradient(90deg,#5b21b6,#7c3aed)"></div>
                <div class="swatch" data-bg="linear-gradient(180deg,#ff7a59,#ffb198)" style="background:linear-gradient(90deg,#ff7a59,#ffb198)"></div>
              </div>
            </div>

            <div>
              <div class="label">Custom Background (pro)</div>
              <input type="text" id="customBg" placeholder="e.g. linear-gradient(90deg,#abc,#def) or #fafafa" />
            </div>

            <div>
              <div class="label">Font Size (px)</div>
              <input id="fontSize" type="range" min="18" max="50" value="50" />
              <div class="meta">Current: <span id="fontSizeVal">64</span>px</div>
            </div>

            <div>
              <div class="label">Border Radius</div>
              <input id="radius" type="range" min="0" max="80" value="18" />
              <div class="meta">Current: <span id="radiusVal">18</span>px</div>
            </div>

            <div style="display:flex;gap:8px;align-items:center">
              <button id="randomizeBtn" class="ghost">Randomize Placement</button>
              <button id="generateBtn" class="generate" style="margin-left:auto">Generate (PNG)</button>
            </div>

            <div style="display:flex;gap:8px;margin-top:8px;align-items:center">
              <div class="muted">Pro features include gradient text, high-res export and unlimited downloads</div>
            </div>

          </div>
        </div>

        <div style="height:12px"></div>

      </section>

      <!-- RIGHT column (tools / info) -->
      <aside>
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div style="font-weight:700">Fluxo Lab</div>
              <div class="muted">Brat text generator â€” clean, fast PNG export</div>
            </div>
            <div class="muted">v3.5</div>
          </div>

          <hr style="margin:12px 0;border:none;border-top:1px solid rgba(0,0,0,0.04)"/>

          <div>
            <div class="label">Options</div>
            <div class="row align-buttons">
              <button id="alignLeft" class="small">Left</button>
              <button id="alignCenter" class="small">Center</button>
              <button id="alignRight" class="small">Right</button>
            </div>
          </div>

          <div style="margin-top:10px">
            <div class="label">Export / Pro</div>
            <div style="display:flex;gap:8px">
              <button id="downloadBtn" class="btn">Download Now</button>
              <button id="resetBtn" class="ghost">Reset</button>
            </div>
            <div class="muted" style="margin-top:8px">Note: Generate hides UI and produces a clean image; Download triggers the same behavior.</div>
          </div>

          <hr style="margin:12px 0;border:none;border-top:1px solid rgba(0,0,0,0.04)"/>

          <div>
            <div class="label">Pro / Unlock</div>
            <div style="display:flex;gap:8px">
              <button id="askPassword" class="small">Enter Password</button>
              <button id="toggleWatermark" class="small">Toggle Watermark</button>
            </div>
            <div class="muted" style="margin-top:8px">Daily exports stored locally. Clearing storage resets counts.</div>
          </div>
        </div>
      </aside>

    </main>

    <footer class="sitefoot">Â© 2025 Crafted with ðŸ’– by Abhiii for the Meme Geeks</footer>
  </div>

<script>
  // === State & storage keys
  const EXPORT_KEY_DATE = 'fluxo_exports_date';
  const EXPORT_KEY_COUNT = 'fluxo_exports_count';
  const PRO_KEY = 'fluxo_pro_unlocked';

  // NOTE: password is intentionally not shown in markup. To avoid leaving a clear-text secret in source,
  // we keep it obfuscated here. This prevents casual discovery while retaining local unlock behavior.
  // For stronger security, move unlock verification to a server-side endpoint.
  const PRO_PASSWORD = atob('QUJISUpFRVQwMTIz'); // decodes to "ABHIJEET0123"

  // DOM refs
  const inputText = document.getElementById('inputText');
  const previewText = document.getElementById('previewText');
  const previewCard = document.getElementById('previewCard');
  const fontSelect = document.getElementById('fontSelect');
  const textColor = document.getElementById('textColor');
  const caseToggle = document.getElementById('caseToggle');
  const outlineSelect = document.getElementById('outlineSelect');
  const glowToggle = document.getElementById('glowToggle');
  const shadowToggle = document.getElementById('shadowToggle');
  const bgSwatches = document.getElementById('bgSwatches');
  const customBg = document.getElementById('customBg');
  const fontSize = document.getElementById('fontSize');
  const fontSizeVal = document.getElementById('fontSizeVal');
  const radius = document.getElementById('radius');
  const radiusVal = document.getElementById('radiusVal');
  const randomizeBtn = document.getElementById('randomizeBtn');
  const generateBtn = document.getElementById('generateBtn');
  const exportCountEl = document.getElementById('exportCount');
  const generateArea = document.getElementById('controlsArea');
  const unlockBtn = document.getElementById('unlockBtn');
  const proBadge = document.getElementById('proBadge');
  const askPassword = document.getElementById('askPassword');
  const watermarkEl = document.getElementById('watermark');
  const toggleWatermark = document.getElementById('toggleWatermark');
  const downloadBtn = document.getElementById('downloadBtn');
  const resetBtn = document.getElementById('resetBtn');
  const previewInner = document.getElementById('previewInner');

  // Initialize
  let isPro = localStorage.getItem(PRO_KEY) === '1';
  let watermarkVisible = true;
  let exportToday = 0;

  function loadExportCount() {
    const savedDate = localStorage.getItem(EXPORT_KEY_DATE) || '';
    const today = new Date().toISOString().slice(0,10);
    if(savedDate !== today) {
      localStorage.setItem(EXPORT_KEY_DATE, today);
      localStorage.setItem(EXPORT_KEY_COUNT, '0');
      exportToday = 0;
    } else {
      exportToday = Number(localStorage.getItem(EXPORT_KEY_COUNT) || '0');
    }
    exportCountEl.textContent = exportToday;
  }
  loadExportCount();
  updateProUI();

  // Helpers
  function updateProUI(){
    if(isPro){
      proBadge.style.display='inline-block';
      unlockBtn.style.display='none';
    } else {
      proBadge.style.display='none';
      unlockBtn.style.display='inline-block';
    }
  }

  function setPreviewFromInputs(){
    let text = inputText.value || '';
    if(caseToggle.dataset.state === 'upper') text = text.toUpperCase();
    previewText.textContent = text;

    // font CSS: we saved value "weight size family"
    const fontVal = fontSelect.value.split(' ');
    previewText.style.fontWeight = fontVal[0] || '700';
    previewText.style.fontSize = (fontSize.value || 64) + 'px';
    previewText.style.fontFamily = fontSelect.value.split(' ').slice(2).join(' ') || 'Inter';

    previewText.style.color = textColor.value;
    // outline
    if(outlineSelect.value === 'none'){
      previewText.style.webkitTextStroke = '0px transparent';
    } else if(outlineSelect.value === 'thin'){
      previewText.style.webkitTextStroke = '2px rgba(0,0,0,0.22)';
    } else {
      previewText.style.webkitTextStroke = '4px rgba(0,0,0,0.23)';
    }
    // glow
    if(glowToggle.checked){
      previewText.style.textShadow = `0 8px 28px rgba(255,82,120,0.14), 0 2px 6px rgba(0,0,0,0.06)`;
    } else {
      previewText.style.textShadow = 'none';
    }
    // drop shadow
    if(shadowToggle.checked){
      previewText.style.filter = 'drop-shadow(0 12px 18px rgba(10,10,10,0.08))';
    } else {
      previewText.style.filter = 'none';
    }
    // border radius
    previewCard.style.borderRadius = radius.value + 'px';
    radiusVal.textContent = radius.value;
    fontSizeVal.textContent = fontSize.value;
  }

  // wire inputs
  inputText.addEventListener('input', setPreviewFromInputs);
  fontSelect.addEventListener('change', setPreviewFromInputs);
  textColor.addEventListener('input', setPreviewFromInputs);
  fontSize.addEventListener('input', setPreviewFromInputs);
  radius.addEventListener('input', setPreviewFromInputs);
  outlineSelect.addEventListener('change', setPreviewFromInputs);
  glowToggle.addEventListener('change', setPreviewFromInputs);
  shadowToggle.addEventListener('change', setPreviewFromInputs);

  // case toggle
  caseToggle.dataset.state = 'upper';
  caseToggle.addEventListener('click', ()=>{
    if(caseToggle.dataset.state === 'upper'){ caseToggle.dataset.state='none'; caseToggle.textContent='lowercase'; }
    else { caseToggle.dataset.state='upper'; caseToggle.textContent='UPPERCASE'; }
    setPreviewFromInputs();
  });

  // background swatches
  bgSwatches.querySelectorAll('.swatch').forEach(s=>{
    s.addEventListener('click', ()=>{
      const bg = s.dataset.bg;
      previewCard.style.background = bg;
    });
  });

  // custom background (pro-only)
  customBg.addEventListener('change', ()=>{
    const v = customBg.value.trim();
    if(!v) return;
    if(!isPro){
      alert('Custom backgrounds are a Pro feature. Enter password to unlock Pro.');
      return;
    }
    previewCard.style.background = v;
  });

  // align buttons
  document.getElementById('alignLeft').addEventListener('click', ()=> previewInner.style.justifyContent = 'flex-start');
  document.getElementById('alignCenter').addEventListener('click', ()=> previewInner.style.justifyContent = 'center');
  document.getElementById('alignRight').addEventListener('click', ()=> previewInner.style.justifyContent = 'flex-end');

  // randomize placement
  randomizeBtn.addEventListener('click', ()=>{
    const aligns = ['flex-start','center','flex-end'];
    previewInner.style.justifyContent = aligns[Math.floor(Math.random()*aligns.length)];
    const pad = 12 + Math.floor(Math.random()*60);
    previewText.style.padding = pad + 'px';
    // random small rotation for fun
    const r = (Math.random()-0.5)*6; previewText.style.transform = `rotate(${r}deg)`;
    setTimeout(()=> previewText.style.transform = 'none', 600);
  });

  // reset function
  function resetAll(){
    inputText.value = "itâ€™s giving main character vibes ðŸ’…";
    previewCard.style.background = 'linear-gradient(180deg,#fff3f8,#ffe6f0)';
    fontSelect.value = "700 64px Inter";
    textColor.value = "#0b1020";
    outlineSelect.value = "none";
    glowToggle.checked = false;
    shadowToggle.checked = false;
    fontSize.value = 64;
    radius.value = 18;
    previewInner.style.justifyContent = 'center';
    previewText.style.padding = '12px';
    watermarkEl.style.display = watermarkVisible ? 'block' : 'none';
    setPreviewFromInputs();
  }
  resetBtn.addEventListener('click', resetAll);

  // watermark toggle
  toggleWatermark.addEventListener('click', ()=>{
    watermarkVisible = !watermarkVisible;
    watermarkEl.style.display = watermarkVisible ? 'block' : 'none';
  });

  // ask password
  askPassword.addEventListener('click', ()=> {
    const raw = prompt('Enter Pro password:');
    if(!raw) { alert('Password entry cancelled.'); return; }
    const pwd = raw.trim();
    if(pwd === PRO_PASSWORD){
      isPro = true;
      localStorage.setItem(PRO_KEY,'1');
      alert('Pro unlocked â€” enjoy unlimited exports and Pro features!');
      updateProUI();
    } else {
      alert('Wrong password.');
    }
  });

  unlockBtn.addEventListener('click', ()=> askPassword.click());

  // quick download helper (wraps generate)
  downloadBtn.addEventListener('click', ()=> generateAndDownload());

  // Generate & export logic
  async function canExportNow(){
    loadExportCount();
    if(isPro) return true;
    if(exportToday >= 2){
      const tryPwd = confirm('You have used 2 free exports today. Enter Pro password to unlock unlimited exports.');
      if(tryPwd){
        const raw = prompt('Enter password:');
        if(!raw) { alert('Password entry cancelled. Export canceled.'); return false; }
        const pwd = raw.trim();
        if(pwd === PRO_PASSWORD){ isPro = true; localStorage.setItem(PRO_KEY,'1'); updateProUI(); return true; }
        alert('Wrong password. Export canceled.'); return false;
      }
      return false;
    }
    return true;
  }

  async function generateAndDownload(){
    if(!await canExportNow()) return;

    // hide UI
    const hideEls = Array.from(document.querySelectorAll('.hide-for-export'));
    // also hide control area explicitly
    document.getElementById('controlsArea').style.visibility = 'hidden';
    document.querySelectorAll('.ghost, .btn, .generate, .small').forEach(x=> x.style.visibility = 'hidden');
    document.querySelector('header.top').style.visibility = 'hidden';
    document.querySelector('footer.sitefoot').style.visibility = 'hidden';

    // option: Pro high-res scale
    const scale = isPro ? 2.4 : 1.4;

    try {
      const canvas = await html2canvas(previewCard, { backgroundColor: null, scale });
      // get image blob
      canvas.toBlob((blob)=>{
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        const name = `fluxo-brat-${Date.now()}.png`;
        a.href = url; a.download = name; document.body.appendChild(a); a.click(); a.remove();
        URL.revokeObjectURL(url);
      }, 'image/png');

      // increment export count if not pro
      if(!isPro){
        exportToday = Number(localStorage.getItem(EXPORT_KEY_COUNT) || '0') + 1;
        localStorage.setItem(EXPORT_KEY_COUNT, String(exportToday));
        localStorage.setItem(EXPORT_KEY_DATE, new Date().toISOString().slice(0,10));
        exportCountEl.textContent = exportToday;
      }
    } catch(e){
      console.error(e);
      alert('Export failed â€” try again.');
    } finally {
      // restore UI
      document.getElementById('controlsArea').style.visibility = 'visible';
      document.querySelectorAll('.ghost, .btn, .generate, .small').forEach(x=> x.style.visibility = 'visible');
      document.querySelector('header.top').style.visibility = 'visible';
      document.querySelector('footer.sitefoot').style.visibility = 'visible';
    }
  }

  generateBtn.addEventListener('click', generateAndDownload);

  // copy of generate for "Download Now" button (downloadBtn) handled above

  // auto update preview on load
  setPreviewFromInputs();

  // small extra: auto-fit behavior (tries to reduce font size if text overflows preview)
  function autoFitText(){
    const maxAttempts = 8;
    let attempts = 0;
    function fit(){
      attempts++;
      const inner = previewInner.getBoundingClientRect();
      const txt = previewText.getBoundingClientRect();
      if((txt.height > inner.height - 20 || txt.width > inner.width - 20) && attempts < maxAttempts){
        const current = Number(fontSize.value);
        if(current > 20){
          fontSize.value = Math.max(20, current - 6);
          setPreviewFromInputs(); fontSizeVal.textContent = fontSize.value;
          requestAnimationFrame(fit);
        }
      }
    }
    setTimeout(fit,120);
  }

  inputText.addEventListener('input', ()=>{
    setPreviewFromInputs();
    autoFitText();
  });

  // Reset daily counts when date changes (run on page load occasionally)
  (function dailyResetCheck(){
    loadExportCount();
    // if date changed in another tab, update UI
    setInterval(loadExportCount, 60*1000);
  })();

  // init
  (function init(){
    watermarkEl.style.display = watermarkVisible ? 'block' : 'none';
    if(isPro) updateProUI();
    setPreviewFromInputs();
  })();

  // Quick keyboard: Ctrl+G to generate
  window.addEventListener('keydown',(e)=>{
    if((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'g'){
      e.preventDefault();
      generateAndDownload();
    }
  });

  // Reset all local storage button (for dev) â€” hidden in UI but accessible by console:
  window.__fluxo_reset = function(){ localStorage.removeItem(EXPORT_KEY_COUNT); localStorage.removeItem(EXPORT_KEY_DATE); localStorage.removeItem(PRO_KEY); alert('Fluxo local storage reset.'); locatio[...]

</script>

</body>
</html>
